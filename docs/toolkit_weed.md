<img style="float:right;width:100px;" src="../img/scarecrow.png" alt="scarecrow"/>

[root](../README.md)

## scarecrow weed
This tool takes a SAM file generated by `scarecrow reap` and a corresponding FASTQ file that was used to generate the SAM file which contains sequence indices in the header, for example:

```bash
@LH00235:395:22LJ3MLT4:3:1101:7045:1042 1:N:0:GNTTGAAGAG+GNTCTCGCCT
```

The tool looks for the sequence at the specified barcode index (i.e. in the above example index 1 is GNTTGAAGAG) in the `--barcodes` whitelist. It outputs a SAM file with updated read tags (CR, CY, CB). The CR tag is appended with the sequence from the FASTQ header, while the CB tag is appended with the matching sequence (which may be the reverse complement). The position (XP) and quality values (CY) for the appended barcode are all set to 0 (phred quality score = !) as they are unknown. The mismatches (XM) are set according to the barcode matching result.

```bash
scarecrow weed --fastq R2.fastq.gz \
    --in extracted.sam \
    --barcodes BC1:v1:v1_whitelist.txt \
    --barcode_index 1 \
    --mismatches 1 \
    --jitter 1 \
    --out final.sam
```
